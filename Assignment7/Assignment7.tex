\documentclass[journal,12pt,twocolumn]{IEEEtran}
%
\usepackage{setspace}
\usepackage{gensymb}
\singlespacing
\usepackage[cmex10]{amsmath}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{txfonts}
\usepackage{stfloats}
\usepackage{bm}
\usepackage{cite}
\usepackage{cases}
\usepackage{subfig}
\usepackage{longtable}
\usepackage{multirow}
%\usepackage{algorithm}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage{steinmetz}
\usepackage{tikz}
\usepackage{circuitikz}
\usepackage{verbatim}
\usepackage{tfrupee}
\usepackage[breaklinks=true]{hyperref}
%\usepackage{stmaryrd}
\usepackage{tkz-euclide} % loads  TikZ and tkz-base
%\usetkzobj{all}
\usetikzlibrary{calc,math}
\usepackage{listings}
\usepackage{color}                                            %%
\usepackage{array}                                            %%
\usepackage{longtable}                                        %%
\usepackage{calc}                                             %%
\usepackage{multirow}                                         %%
\usepackage{hhline}                                           %%
\usepackage{ifthen}                                           %%
%optionally (for landscape tables embedded in another document): %%
\usepackage{lscape}     
\usepackage{multicol}
\usepackage{chngcntr}
%\usepackage{enumerate}

%\usepackage{wasysym}
%\newcounter{MYtempeqncnt}
\DeclareMathOperator*{\Res}{Res}
%\renewcommand{\baselinestretch}{2}
\renewcommand\thesection{\arabic{section}}
\renewcommand\thesubsection{\thesection.\arabic{subsection}}
\renewcommand\thesubsubsection{\thesubsection.\arabic{subsubsection}}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\renewcommand\thesectiondis{\arabic{section}}
\renewcommand\thesubsectiondis{\thesectiondis.\arabic{subsection}}
\renewcommand\thesubsubsectiondis{\thesubsectiondis.\arabic{subsubsection}}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}
\def\inputGnumericTable{}                                 %%

\lstset{
	%language=C,
	frame=single, 
	breaklines=true,
	columns=fullflexible
}


\begin{document}
	%
	
	
	\newtheorem{theorem}{Theorem}[section]
	\newtheorem{problem}{Problem}
	\newtheorem{proposition}{Proposition}[section]
	\newtheorem{lemma}{Lemma}[section]
	\newtheorem{corollary}[theorem]{Corollary}
	\newtheorem{example}{Example}[section]
	\newtheorem{definition}[problem]{Definition}
	
	\newcommand{\BEQA}{\begin{eqnarray}}
	\newcommand{\EEQA}{\end{eqnarray}}
	\newcommand{\define}{\stackrel{\triangle}{=}}
	\bibliographystyle{IEEEtran}
	%\bibliographystyle{ieeetr}
	\providecommand{\mbf}{\mathbf}
	\providecommand{\pr}[1]{\ensuremath{\Pr\left(#1\right)}}
	\providecommand{\qfunc}[1]{\ensuremath{Q\left(#1\right)}}
	\providecommand{\sbrak}[1]{\ensuremath{{}\left[#1\right]}}
	\providecommand{\lsbrak}[1]{\ensuremath{{}\left[#1\right.}}
	\providecommand{\rsbrak}[1]{\ensuremath{{}\left.#1\right]}}
	\providecommand{\brak}[1]{\ensuremath{\left(#1\right)}}
	\providecommand{\lbrak}[1]{\ensuremath{\left(#1\right.}}
	\providecommand{\rbrak}[1]{\ensuremath{\left.#1\right)}}
	\providecommand{\cbrak}[1]{\ensuremath{\left\{#1\right\}}}
	\providecommand{\lcbrak}[1]{\ensuremath{\left\{#1\right.}}
	\providecommand{\rcbrak}[1]{\ensuremath{\left.#1\right\}}}
	\theoremstyle{remark}
	\newtheorem{rem}{Remark}
	\newcommand{\sgn}{\mathop{\mathrm{sgn}}}
	\providecommand{\abs}[1]{\left\vert#1\right\vert}
	\providecommand{\res}[1]{\Res\displaylimits_{#1}} 
	\providecommand{\norm}[1]{\left\lVert#1\right\rVert}
	%\providecommand{\norm}[1]{\lVert#1\rVert}
	\providecommand{\mtx}[1]{\mathbf{#1}}
	\providecommand{\mean}[1]{E\left[ #1 \right]}
	\providecommand{\fourier}{\overset{\mathcal{F}}{ \rightleftharpoons}}
	%\providecommand{\hilbert}{\overset{\mathcal{H}}{ \rightleftharpoons}}
	\providecommand{\system}{\overset{\mathcal{H}}{ \longleftrightarrow}}
	%\newcommand{\solution}[2]{\textbf{Solution:}{#1}}
	\newcommand{\solution}{\noindent \textbf{Solution: }}
	\newcommand{\cosec}{\,\text{cosec}\,}
	\providecommand{\dec}[2]{\ensuremath{\overset{#1}{\underset{#2}{\gtrless}}}}
	\newcommand{\myvec}[1]{\ensuremath{\begin{pmatrix}#1\end{pmatrix}}}
	\newcommand{\mydet}[1]{\ensuremath{\begin{vmatrix}#1\end{vmatrix}}}
	\numberwithin{equation}{subsection}
	\makeatletter
	\@addtoreset{figure}{problem}
	\makeatother
	\let\StandardTheFigure\thefigure
	\let\vec\mathbf
	\renewcommand{\thefigure}{\theproblem}
	\def\putbox#1#2#3{\makebox[0in][l]{\makebox[#1][l]{}\raisebox{\baselineskip}[0in][0in]{\raisebox{#2}[0in][0in]{#3}}}}
	\def\rightbox#1{\makebox[0in][r]{#1}}
	\def\centbox#1{\makebox[0in]{#1}}
	\def\topbox#1{\raisebox{-\baselineskip}[0in][0in]{#1}}
	\def\midbox#1{\raisebox{-0.5\baselineskip}[0in][0in]{#1}}
	\vspace{3cm}
	\title{Assignment 7}
	\author{Neha Rani \\ EE20MTECH14014}
	
	
	\maketitle
	\newpage
	%\tableofcontents
	\bigskip
	\renewcommand{\thefigure}{\theenumi}
	\renewcommand{\thetable}{\theenumi}
	\counterwithout{figure}{section}
	\counterwithout{figure}{subsection}
	%\begin{document}	
	%	\begin{titlepage}
	%	\begin{center}
	%		\vspace*{1cm}
	%		
	%		\textbf{ \huge{Assignment 1}}
	%		\vspace{1.5cm}
	%		
	%		\textbf{Ritesh Kumar} \\
	%		textbf{(EE20RESCH11005)}\\
	%		\textbf{Communication and Signal Processing}
	\date{Today}
	
	%	\end{center}
	%	\end{titlepage}
\begin{abstract}
This problem demonstrate a method to  find the foot perpendicular  from a given point to a given plane using Singular Value Decomposition.
\end{abstract}
All the codes for the figure in this document can be found at
\begin{lstlisting}
https://github.com/neharani289/Assignment7/tree/master/Assignment7
\end{lstlisting}
\section{\textbf{Problem}}
Set up the equation of a plane through the point A $\left(-2, -3, 4 \right)$ and perpendicular to the line 
\begin{align}
\frac{x}{4} = \frac{y - 3}{6} = \frac{z+2}{-12} \label{eq1.1}
\end{align}
 \section{\textbf{Solution}} 
 Let the equation of plane is 
 \begin{align}
 ax +by +cz +d = 0 \label{eq2.1}
 \end{align}
 
% we can express \eqref{eq2.1} as ,
% \begin{align}
%\myvec{a & b & c}\vec{x} = -d
% \end{align}
Direction ratio of the line \eqref{eq1.1} is given as 
\begin{align}
\vec{D} = \myvec{4\\ 6 \\ -12}
\end{align}
\begin{align}
\intertext{ Now let consider } 
\vec{A} = \myvec{-2 & -3 & 4} 
\intertext{Since plane is passing through the point A (-2, -3, 4 ) and perpendicular to the line \eqref{eq1.1}, hence}
\vec{A}\vec{D} + d = 0 \\
\implies d = 37
\end{align}
Hence equation of the plane is 
\begin{align}
2x + 3y + 6z + 37 = 0 \\
\implies 2x + 3y - 6z = -37 \label{2.7}
\end{align} 
equation \eqref{2.7} can written as :
\begin{align}
\myvec{2 & 3 & -6}\vec{x} = -37
\end{align}
For foot perpendicular we need to find the distance between the plane and point P $\left( 0, 3, -2\right)$.\\ 
First we find orthogonal vectors $\vec{m_1}$ and $\vec{m_2}$ to the given normal vector $\vec{n}$. Let, $\vec{m}$ = $\myvec{a\\b\\c}$, then
\begin{align}
\vec{m^T}\vec{n} &= 0\\
\implies\myvec{a&b&c}\myvec{2\\3\\-6} &= 0\\
\implies 2a+3b-6c &= 0\\
\intertext{Putting a=1 and b=0 we get,}
\vec{m_1} &= \myvec{1\\0\\\frac{1}{3} }\\
\intertext{Putting a=0 and b=1 we get,}
\vec{m_2} &= \myvec{0\\1\\ \frac{1}{2}}
\end{align}
Now we solve the equation,
\begin{align}
\vec{M}\vec{x} &= \vec{b}\label{eq1}\\
\intertext{Putting values in \eqref{eq1},}
\myvec{1&0\\0&1\\ \frac{1}{3}& \frac{1}{2}}\vec{x} &= \myvec{0\\3\\-2}\label{eq2}
\end{align}
Now, to solve \eqref{eq2}, we perform Singular Value Decomposition on $\vec{M}$ as follows,
\begin{align}
\vec{M}=\vec{U}\vec{S}\vec{V}^T\label{eqSVD}
\end{align}
Where the columns of $\vec{V}$ are the eigen vectors of $\vec{M}^T\vec{M}$ ,the columns of $\vec{U}$ are the eigen vectors of $\vec{M}\vec{M}^T$ and $\vec{S}$ is diagonal matrix of singular value of eigenvalues of $\vec{M}^T\vec{M}$.
\begin{align}
\vec{M}^T\vec{M}=\myvec{\frac{10}{9}& \frac{1}{6}\\ \frac{1}{6}&\frac{5}{4}}\label{eqMTM}\\
\vec{M}\vec{M}^T=\myvec{1&0& \frac{1}{3}\\0&1& \frac{1}{2}\\ \frac{1}{3}& \frac{1}{2}& \frac{13}{36}}
\end{align}
From \eqref{eq1} putting \eqref{eqSVD} we get,
\begin{align}
\vec{U}\vec{S}\vec{V}^T\vec{x} & = \vec{b}\\
\implies\vec{x} &= \vec{V}\vec{S_+}\vec{U^T}\vec{b}\label{eqX}
\end{align}
Where $\vec{S_+}$ is Moore-Penrose Pseudo-Inverse of $\vec{S}$.Now, calculating eigen value of $\vec{M}\vec{M}^T$,


\begin{align}
\mydet{\vec{M}\vec{M}^T - \lambda\vec{I}} &= 0\\
\implies\myvec{1-\lambda&0& \frac{1}{3} \\0&1-\lambda& \frac{1}{2}\\   \frac{1}{3}& \frac{1}{2}&\frac{13}{36}-\lambda} &=0\\
\implies\lambda (\lambda - 1)(\lambda - \frac{49}{36}) &=0
\end{align}


Hence eigen values of $\vec{M}\vec{M}^T$ are,
\begin{align}
\lambda_1 &= \frac{49}{36}\\
\lambda_2 &= 1\\
\lambda_3 &= 0\\
\end{align}
Hence the eigen vectors of $\vec{M}\vec{M}^T$ are,
\begin{align}
\vec{u_1}=\myvec{\frac{12}{13}\\\frac{18}{13}\\1}\quad
\vec{u_2}=\myvec{\frac{-3}{2}\\1\\0}\quad
\vec{u_3}=\myvec{\frac{-1}{3}\\\frac{-1}{2}\\1}
\end{align}
\intertext{Normalizing the eigen vectors we get,}
\begin{align}
\vec{u_1}=\myvec{\frac{12}{7\sqrt{13}}\\\frac{18}{7\sqrt{13}}\\\frac{\sqrt{13}}{7}}\quad
\vec{u_2}=\myvec{\frac{-3}{\sqrt{13}}\\\frac{2}{\sqrt{13}}\\0}\quad
\vec{u_3}=\myvec{\frac{-2}{7}\\\frac{-3}{7}\\\frac{6}{7}}
\end{align}
Hence we obtain $\vec{U}$ of \eqref{eqSVD} as follows,
\begin{align}
\vec{U}=\myvec{\frac{12}{7\sqrt{13}}&\frac{-3}{\sqrt{13}}&\frac{-2}{7}\\\frac{18}{7\sqrt{13}}&\frac{2}{\sqrt{13}}&\frac{-3}{7}\\\frac{\sqrt{13}}{7}&0&\frac{6}{7}}\label{eqU}
\end{align}
After computing the singular values from eigen values $\lambda_1, \lambda_2, \lambda_3$ we get $\vec{S}$ of \eqref{eqSVD} as follows,
\begin{align}
\vec{S}=\myvec{\frac{7}{6}&0\\0&1\\0&0}\label{eqS}
\end{align}
Now, calculating eigen value of $\vec{M}^T\vec{M}$,
\begin{align}
\mydet{\vec{M}^T\vec{M} - \lambda\vec{I}} &= 0\\
\implies\mydet{\frac{5}{4}-\lambda&\frac{1}{6}\\\frac{1}{6}&\frac{10}{9}-\lambda} &=0\\
\implies\lambda^2-\frac{85}{36}\lambda+\frac{49}{36} &=0
\end{align}
Hence eigen values of $\vec{M}^T\vec{M}$ are,
\begin{align}
\lambda_1 = \frac{49}{36}\quad
\lambda_2 = 1
\end{align}
Hence the eigen vectors of $\vec{M}^T\vec{M}$ are,
\begin{align}
\vec{v}_1=\myvec{\frac{2}{3}\\1} \quad
\vec{v}_2=\myvec{\frac{-3}{2}\\1}
\end{align}
Normalizing the eigen vectors,
\begin{align}
\vec{v}_1=\myvec{\frac{2}{\sqrt{13}}\\\frac{3}{\sqrt{13}}} \quad
\vec{v}_2=\myvec{\frac{-3}{\sqrt{13}}\\\frac{2}{\sqrt{13}}}
\end{align}
Hence we obtain $\vec{V}$ of \eqref{eqSVD} as follows,
\begin{align}
\vec{V}=\myvec{\frac{2}{\sqrt{13}}&\frac{-3}{\sqrt{13}}\\\frac{3}{\sqrt{13}}&\frac{2}{\sqrt{13}}}
\end{align}
Finally from \eqref{eqSVD} we get the Singualr Value Decomposition of $\vec{M}$ as follows,
\begin{align}
\vec{M} = \myvec{\frac{12}{7\sqrt{13}}&\frac{-3}{\sqrt{13}}&\frac{-2}{7}\\\frac{18}{7\sqrt{13}}&\frac{2}{\sqrt{13}}&\frac{-3}{7}\\\frac{\sqrt{13}}{7}&0&\frac{6}{7}}\myvec{\frac{7}{6}&0\\0&1\\0&0}\myvec{\frac{2}{\sqrt{13}}&\frac{-3}{\sqrt{13}}\\\frac{3}{\sqrt{13}}&\frac{2}{\sqrt{13}}}^T
\end{align}
Now, Moore-Penrose Pseudo inverse of $\vec{S}$ is given by,
\begin{align}
\vec{S_+} =\myvec{\frac{6}{7}&0&0\\0&1&0}
\end{align}
From \eqref{eqX} we get,
\begin{align}
\vec{U}^T\vec{b}&=\myvec{\frac{4}{\sqrt{13}}\\\frac{6}{\sqrt{13}}\\-3}\\
\vec{S_+}\vec{U}^T\vec{b}&=\myvec{\frac{24}{7\sqrt{13}}\\\frac{6}{\sqrt{13}}}\\
\vec{x} &= \vec{V}\vec{S_+}\vec{U}^T\vec{b} &= \myvec{\frac{-6}{7}\\\frac{12}{7}}\label{eqXSol1}
\end{align}
Verifying the solution of \eqref{eqXSol1} using,
\begin{align}
\vec{M}^T\vec{M}\vec{x} = \vec{M}^T\vec{b}\label{eqVerify}
\end{align}
Evaluating the R.H.S in \eqref{eqVerify} we get,
\begin{align}
\vec{M}^T\vec{M}\vec{x} &= \myvec{\frac{-2}{3}\\ 2}\\
\implies\myvec{\frac{10}{9}&\frac{1}{6}\\\frac{1}{6}&\frac{5}{4}}\vec{x} &= \myvec{\frac{-2}{3}\\2}\label{eqMateq}
\end{align}
Solving the augmented matrix of \eqref{eqMateq} we get,
\begin{align}
\myvec{\frac{10}{9}&\frac{1}{6}& \frac{-2}{3}\\\frac{1}{6}&\frac{5}{4}& 2} &\xleftrightarrow{R_1=\frac{9R_1}{10}}\myvec{1&\frac{3}{20}&\frac{-3}{5}\\\frac{1}{6}&\frac{5}{4}&2}\\
&\xleftrightarrow{R_2=R_2-\frac{R_1}{6}}\myvec{1&\frac{3}{20}&\frac{-3}{5}\\0&\frac{49}{40}&\frac{21}{10}}\\
&\xleftrightarrow{R_2=\frac{40}{49}R_2}\myvec{1&\frac{3}{20}&\frac{-3}{5}\\0&1&\frac{12}{7}}\\
&\xleftrightarrow{R_1=R_1-\frac{3R_2}{20}}\myvec{1&0&\frac{-6}{7}\\0&1&\frac{12}{7}}
\end{align}
Hence, Solution of \eqref{eqVerify} is given by,
\begin{align}
\vec{x}=\myvec{\frac{-6}{7}\\\frac{12}{7}}\label{eqX2}
\end{align}
Comparing results of $\vec{x}$ from \eqref{eqXSol1} and \eqref{eqX2} we conclude that the solution is verified.
\end{document}